<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>CCCC · Visualització de Castells</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />

<link href="styles.css" rel="stylesheet" />

<style>
#loader {
  position: fixed;
  inset: 0;
  background: white;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
  font-family: Oswald;
}
.spinner-border {
  width:3rem;
  height:3rem;
}
</style>

</head>

<body>

<!-- LOADER -->
<div id="loader">
  <div class="spinner-border" role="status"></div>
  <div>CARREGANT DADES…</div>
</div>

<!-- HEADER -->
<header class="cccc-header">

  <div class="cccc-logo">castells</div>

  <nav class="cccc-nav">
    <span class="active" onclick="mostrarGrafics()">VISUALITZACIÓ</span>
    <span onclick="mostrarMapa()">MAPA</span>
  </nav>

</header>

<!-- HERO -->
<div class="hero"></div>

<!-- GRÀFICS -->
<div id="seccioGrafics" class="container my-5">

<h1 class="cccc-title">VISUALITZACIÓ DE CASTELLS</h1>

<div class="row">

<div class="col-md-3">
<label>Colla</label>
<select id="filterColla" class="form-select"><option value="">Totes</option></select>
</div>

<div class="col-md-3">
<label>Any</label>
<select id="filterYear" class="form-select"><option value="">Tots</option></select>
</div>

<div class="col-md-3">
<label>Tipus</label>
<select id="filterTipusCastell" class="form-select"><option value="">Tots</option></select>
</div>

<div class="col-md-3">
<label>Resultat</label>
<select id="filterResultat" class="form-select"><option value="">Tots</option></select>
</div>

</div>

<div class="row mt-3">

<div class="col-md-3">
<label>Visualització</label>
<select id="filterVisualitzacio" class="form-select">
<option value="any">Per any</option>
<option value="colla">Per colla</option>
<option value="tipusCastell">Per tipus</option>
<option value="resultat">Per resultat</option>
</select>
</div>

</div>

<div class="chart-wrapper">
  <canvas id="chartCastells"></canvas>
</div>

</div>

<!-- MAPA -->

<div id="seccioMapa" class="container my-5" style="display:none">

<h1 class="cccc-title">MAPA DE PLACES CASTELLERES</h1>

<div class="row">

<div class="col-md-3">
<label>Colla</label>
<select id="filterCollaMap" class="form-select"><option value="">Totes</option></select>
</div>

<div class="col-md-3">
<label>Any</label>
<select id="filterYearMap" class="form-select"><option value="">Tots</option></select>
</div>

<div class="col-md-3">
<label>Tipus</label>
<select id="filterTipusCastellMap" class="form-select"><option value="">Tots</option></select>
</div>

<div class="col-md-3">
<label>Resultat</label>
<select id="filterResultatMap" class="form-select"><option value="">Tots</option></select>
</div>

</div>

<div id="map"></div>

</div>

<!-- LLIBRERIES -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- SCRIPTS PROPIS -->
<script src="app.js"></script>
<script src="coordenades.js"></script>
<script src="mapa.js"></script>

<script>
let mapaInicialitzat=false;

function mostrarGrafics(){
document.getElementById("seccioGrafics").style.display="block";
document.getElementById("seccioMapa").style.display="none";
}

function mostrarMapa(){
document.getElementById("seccioGrafics").style.display="none";
document.getElementById("seccioMapa").style.display="block";

if(!mapaInicialitzat){
inicialitzarMapa();
omplirFiltresMapa();
dibuixarMapa();
mapaInicialitzat=true;
setTimeout(() => {
  map.invalidateSize(true);
}, 300);
}
}
</script>

</body>
</html>









